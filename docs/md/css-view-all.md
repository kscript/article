### 多行文本省略添加 查看全部 效果

最近做一些移动端的页面, 需要给 多行文本在加省略号的同时, 添加 查看全部 效果。  
这个需求看似简单, 仔细想来却不太好实现, 多行文本加省略号简单, 可是要在后面多出一个按钮来, 似乎不太现实啊, 网上找了下也没有好的例子, 无奈之下只好自己踩坑。  
首先, 根据这个需求, 设想了几种方案:   
1. 在字符间插入空标签, 计算出一个合适的位置, 然后把 查看全部 按钮放进去  
2. 用js计算文本字符实际占用的空间, 手动加省略号  
3. 计算出多行省略的最后一行, 使用单行省略的解决方案  
4. 使用绝对定位  

当然了, 以上几种方案都不是很理想: 前三种, 第一个要找合适的位置, 二、三要计算合适的空间, 太过于麻烦, 第四种虽然简单, 却过于粗暴, 在中英文混杂的情况下, 按钮很可能盖到文字的一部分。  
这么一合计, 感觉前景有些灰暗啊, 难道没有别的方案了吗? 答案当然是有~的~ (不然岂不是白写了这篇文章么)  
其实一开始看完这个需求的时候, 就让我想到以前 单行文本+省略号+其它标签 的解决方案了, 虽然在上面提到的时候, 已经让我给否了, 但还是有参考价值的, 不知道各位有没有实现过单行时的效果, 类似于这样:  

```html
<style>
    .text {
        width: 200px;
    }
    .ellipsis {
        overflow: hidden;
        text-overflow: ellipsis;
        white-space: nowrap;
    }
    .right{
        float: right;
    }
</style>
<div class="text ellipsis">
    <span class="right">右侧浮动文本</span>
    正常文本正常文本正常文本正常文本正常文本正常文本
</div>
```

很可惜, 单行文本的解决方案, 并不适合于多行文本, 但是这让我想到了张鑫旭的一篇文章[<<借助CSS Shapes实现元素滚动自动环绕iPhone X的刘海>>](https://www.zhangxinxu.com/wordpress/2017/09/css-shapes-outside-iphone-x-head/)。   
尝试了这篇讲元素环绕的文章, 折腾了许久, 最终研究出了一个解决方案, 这个方案需要js做一些简单的配合  
>> [点击查看最终解决方案](https://codepen.io/kscript/pen/JjoYMeZ)

原理: 使用CSS Shapes, 实现类似单行省略+右侧浮动的效果  
比较坑点:  
1. 查看全部按钮必须等多行文本渲染完, 再添加进去(需要js配合)  
2. CSS Shapes 和 多行文本要在同一个BFC(不在同一个BFC的话, 不能产生类似单行浮动时的效果)